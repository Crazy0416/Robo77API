# Robo77API

## 이벤트 설명(client->server)

### 1. 유저 게임 참가

- **이벤트 명**: joinRoom
- **설명**: 방에 참가하고 싶은 유저가 roomId 방에 들어가고 싶다는 의사를 알림
- **요청 대상**: 방에 들어가고 싶은 유저 -> 서버
- **요청 데이터**: 

| 이름   | 설명      | 타입   | 비고 |
| ------ | --------- | ------ | ---- |
| roomId | 룸 아이디 | Number |      |

### 2. 딜러 게임 방 생성

- **이벤트 명**: createRoom
- **설명**: 방 생성하고 딜러에게 특성을 부여하기 위해 따로 이벤트를 만들었다.
- **요청 대상**: 딜러(게임 방장이 되고 싶은 유저) -> 서버
- **요청 데이터**: 

| 이름   | 설명      | 타입   | 비고 |
| ------ | --------- | ------ | ---- |
| roomId | 룸 아이디 | String |      |

### 3. 카드 제출

- **이벤트 명**: emitCard
- **설명**: 턴 유저가 카드를 제출
- **요청 대상**: 현재 카드를 내야하는 유저 -> 서버
- **요청 데이터**: 

| 이름     | 설명                  | 타입   | 비고                                                         |
| -------- | --------------------- | ------ | ------------------------------------------------------------ |
| roomId   | 유저가 속한 방 아이디 | Number |                                                              |
| socketId | 유저 아이디           | String | socket.io가 가지는 unique id                                 |
| cardType | 카드 타입             | Number | 일반카드, 특수 카드등(나중에 적용할 것) <br />일반 카드: 0, 특수 카드 1 |
| cardNum  | 카드의 숫자           | Number | 카드 숫자                                                    |
| cardId   | 카드 고유 아이디      | Number | 인덱스                                                       |

### 4. 딜러 게임 시작

- **이벤트 명**: gameStart
- **설명**: 게임 ready 상태에서 게임을 시작함
- **요청 대상**: 딜러(게임 방장) -> 서버
- **요청 데이터**: 

| 이름     | 설명                | 타입   | 비고 |
| -------- | ------------------- | ------ | ---- |
| socketId | 딜러(자신)의 아이디 | String |      |
| roomId   | 룸 아이디           | Number |      |

**※** 요청 후 방에 존재하는 모든 유저에게 setStart 이벤트 emit



### 5. 11의 배수 이벤트 

- **이벤트 명**: multiplesOf11
- **설명**: 딜러가 어떤 유저가 카드를 내서 총합이 11의 배수가 되었음을 알림
- **요청 대상**: 딜러(게임 방장) -> 서버
- **요청 데이터**: 

| 이름     | 설명                              | 타입   | 비고                  |
| -------- | --------------------------------- | ------ | --------------------- |
| roomId   | 유저가 속한 룸 아이디             | Number |                       |
| socketId | 11의 배수가 된 유저의 소켓 아이디 | String | socket.io의 unique id |

**※** 요청 후 서버 상태에서 하트 깎고 다음 유저에게 turnStart 이벤트 emit



### 6. 77 게임 오버 이벤트

- **이벤트 명**: gameOver77
- **설명**: 딜러가 어떤 유저가 카드를 내서 총합이 77 이상임을 알림
- **요청 대상**: 딜러(게임 방장) -> 서버
- **요청 데이터**: 

| 이름     | 설명                            | 타입   | 비고                  |
| -------- | ------------------------------- | ------ | --------------------- |
| roomId   | 유저가 속한 룸 아이디           | Number |                       |
| socketId | 77 이상이 된 유저의 소켓 아이디 | String | socket.io의 unique id |

**※** 요청 후 서버 상태에서 하트 깎고 모든 유저에게 setOver 이벤트 emit



### 7. no Condition 이벤트

- **이벤트 명**: noCondition
- **설명**: 딜러가 어떤 유저가 카드를 내서 아무 이상이 없음을 알림
- **요청 대상**: 딜러(게임 방장) -> 서버
- **요청 데이터**: 

| 이름     | 설명                                | 타입   | 비고                  |
| -------- | ----------------------------------- | ------ | --------------------- |
| roomId   | 유저가 속한 룸 아이디               | Number |                       |
| socketId | 아무 이상이 없는 유저의 소켓 아이디 | String | socket.io의 unique id |

**※** 요청 후  다음 유저에게 turnStart 이벤트 emit



## 이벤트 설명(Server->Client)

### 1. 방금 받은 카드 딜러에게 전달 이벤트

- **이벤트 명**: cardInfoToDealer
- **설명**: 방금 클라이언트에게 받은 카드를 딜러(방장)에게 전달
- **요청 대상**: 서버 -> 딜러(게임 방장)
- **요청 데이터**: 

| 이름     | 설명                              | 타입   | 비고                                                         |
| -------- | --------------------------------- | ------ | ------------------------------------------------------------ |
| socketId | 방금 카드를 낸 유저의 소켓 아이디 | String | socket.io의 unique id                                        |
| cardId   | 유저가 낸 카드 아이디             | Number |                                                              |
| cardType | 유저가 낸 카드 타입               | Number | 일반카드, 특수 카드등(나중에 적용할 것) <br />일반 카드: 0, 특수 카드 1 |
| cardNum  | 유저가 낸 카드의 숫자             | Number | 새로 발급하는 카드 숫자                                      |



### 2. turnEnd 후 현재 클라이언트 상태 업데이트 이벤트 

- **이벤트 명**: turnEndAndUpdate
- **설명**: 방금 카드를 낸 클라이언트의 턴 종료를 알림과 동시에 클라이언트 상태를 업데이트
- **요청 대상**: 서버 -> 방금 카드를 낸 유저
- **요청 데이터**: 

| 이름     | 설명                         | 타입   | 비고                                                         |
| -------- | ---------------------------- | ------ | ------------------------------------------------------------ |
| socketId | 유저 아이디                  | String | socket.io가 가지는 unique id                                 |
| heart    | 하트 상태                    | Number | -1 혹은 0                                                    |
| cardType | 새로 받은 카드 타입          | Number | 일반카드, 특수 카드등(나중에 적용할 것) <br />일반 카드: 0, 특수 카드 1<br/>새로 발급하는 카드 타입 |
| cardNum  | 새로 받은 카드의 숫자        | Number | 새로 발급하는 카드 숫자                                      |
| cardId   | 새로 받은 카드 고유의 아이디 | Number |                                                              |

### 3. 유저 턴 시작 이벤트

- **이벤트 명**: turnStart
- **설명**: 다음 카드를 내야할 유저에게 턴 시작을 알리는 이벤트
- **요청 대상**: 서버 -> 카드를 내야할 유저
- **요청 데이터**: X



### 4. 세트 종료 이벤트

- **이벤트 명**: setOver
- **설명**: 카드 총 합이 77 이상이 되어서 세트가 종료되었음을 알림
- **요청 대상**: 서버 -> 방에 있는 모든 클라이언트
- **요청 데이터**: X



### 5. 세트 시작 이벤트

- **이벤트 명**: setStart
- **설명**: 게임이 맨 초반 시작되었거나 세트가 종료 된 후 다음 세트가 시작 되었음을 알림
- **요청 대상**: 서버 -> 딜러를 제외한 방에 존재하는 클라이언트
- **요청 데이터**: 

| 이름     | 설명               | 타입   | 비고                                                         |
| -------- | ------------------ | ------ | ------------------------------------------------------------ |
| socketId | 유저 아이디        | String | socket.io가 가지는 unique id                                 |
| cards    | 카드들의 배열      | Array  | 뒤에 객체 타입의 카드 키값들을 표시                          |
| -        |                    |        |                                                              |
| cardType | 카드 타입          | Number | 일반카드, 특수 카드등(나중에 적용할 것) <br />일반 카드: 0, 특수 카드 1 |
| cardNum  | 카드의 숫자        | Number | 카드 숫자                                                    |
| cardId   | 카드 고유의 아이디 | Number |                                                              |

example:

{

​	"socketId": "abcd",

​	"cards": [

​		{

​			cardType: 0,

​			cardNum: 9

​		}, {} ...

​	]

}



### 6. 게임 종료 이벤트

- **이벤트 명**: gameOver
- **설명**: 유저 한명이 라이프 코인을 다 잃어 게임이 종료되었음을 알리는 이벤트
- **요청 대상**: 서버 -> 방에 존재하는 모든 클라이언트
- **요청 데이터**: X